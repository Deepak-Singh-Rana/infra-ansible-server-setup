---
# tasks file for configure_rhel_subscription
#https://docs.ansible.com/ansible/latest/modules/rhn_register_module.html

- name: Install Satellite key
  yum:
    name: http://snzclakl173.nzc.co.nz/pub/rhn-org-trusted-ssl-cert-1.0-1.noarch.rpm
    state: present
  when: ansible_distribution == "RedHat"

- name: Register with activationkey and enable extended update support
  rhn_register:
    state: present
    activationkey: 1-c315eaa3a0c87cd743e162cb665a7f46
    enable_eus: yes
    server_url: https://snzclakl173.nzc.co.nz/XMLRPC
    channels:  rhel-x86_64-baseos-8,rhel-x86_64-appstream-8,epel-x86_64-server8
